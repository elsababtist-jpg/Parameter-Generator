<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Form Generator</title>
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #ffffff;
    }

    .app {
      height: 100vh;
      border: 1px solid #444;
      display: flex;
    }

    /* --- Sidebar --- */

    .sidebar {
      width: 260px;
      background: #e9e9e9;
      border-right: 1px solid #444;
      padding: 12px 16px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .title {
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 4px;
    }

    .separator {
      height: 1px;
      background: #444;
      margin-top: 4px;
    }

    .control { font-size: 13px; }

    .control-label {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 4px;
    }

    .bullet {
      width: 10px;
      height: 10px;
      background: #000;
    }

    .slider {
      width: 100%;
      -webkit-appearance: none;
      appearance: none;
      height: 2px;
      background: #c4c4c4;
      outline: none;
    }

    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 10px;
      height: 10px;
      background: #000;
      cursor: pointer;
    }

    .slider::-moz-range-thumb {
      width: 10px;
      height: 10px;
      background: #000;
      cursor: pointer;
      border: none;
    }

    .button-row {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .button-row span { font-size: 13px; }

    .btn {
      margin-top: 4px;
      width: 100%;
      padding: 4px 0;
      font-size: 12px;
      border: 1px solid #000;
      background: #fff;
      cursor: pointer;
    }

    .btn:hover { background: #f0f0f0; }

    /* --- Main / Canvas-Bereich --- */

    .main {
      flex: 1;
      background: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .canvas-frame {
      width: 320px;
      height: 320px;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    svg {
      width: 100%;
      height: 100%;
      display: block;
    }
  </style>
</head>
<body>
<div class="app">

  <!-- Sidebar links -->
  <aside class="sidebar">
    <div>
      <div class="title">Form Generator … Titel</div>
      <div class="separator"></div>
    </div>

    <!-- Generate Shape -->
    <div class="control">
      <div class="control-label">
        <div class="bullet"></div>
        <span>Generate Shape</span>
      </div>
      <button class="btn" id="generateBtn">Generate</button>
    </div>

    <!-- Flächenfüllung -->
    <div class="control">
      <div class="control-label">
        <div class="bullet"></div>
        <span>Flächenfüllung</span>
      </div>
      <input class="slider" type="range" min="0" max="100" value="40" id="fillSlider">
    </div>

    <!-- Bezierkurven -->
    <div class="control">
      <div class="control-label">
        <div class="bullet"></div>
        <span>Bezierkurven</span>
      </div>
      <input class="slider" type="range" min="0" max="100" value="80" id="bezierSlider">
    </div>

    <!-- Vergrößern -->
    <div class="control">
      <div class="control-label">
        <div class="bullet"></div>
        <span>Vergrößern</span>
      </div>
      <input class="slider" type="range" min="0" max="100" value="50" id="scaleSlider">
    </div>

    <!-- Verzerren -->
    <div class="control">
      <div class="control-label">
        <div class="bullet"></div>
        <span>Verzerren</span>
      </div>
      <input class="slider" type="range" min="0" max="100" value="30" id="distortSlider">
    </div>

    <!-- Invert (optional für später) -->
    <div class="control">
      <div class="control-label">
        <div class="bullet"></div>
        <span>Invert</span>
      </div>
      <input class="slider" type="range" min="0" max="100" value="0" id="invertSlider">
    </div>

    <!-- Clear Canvas -->
    <div class="control">
      <div class="button-row">
        <div class="bullet"></div>
        <span>Clear Canvas</span>
      </div>
      <button class="btn" id="clearBtn">Clear</button>
    </div>

    <!-- Export as svg -->
    <div class="control">
      <div class="button-row">
        <div class="bullet"></div>
        <span>Export as svg.</span>
      </div>
      <button class="btn" id="exportBtn">Export</button>
    </div>
  </aside>

  <!-- Hauptbereich rechts -->
  <main class="main">
    <div class="canvas-frame">
      <!-- SVG, in dem die Form generiert wird -->
      <svg id="shapeCanvas" viewBox="0 0 320 320" xmlns="http://www.w3.org/2000/svg">
        <rect id="bgRect" width="320" height="320" fill="black" />
        <path id="shapePath" fill="white" />
      </svg>
    </div>
  </main>

</div>

<script>
  const shapePath   = document.getElementById("shapePath");
  const bgRect      = document.getElementById("bgRect");
  const fillSlider  = document.getElementById("fillSlider");
  const bezierSlider= document.getElementById("bezierSlider");
  const scaleSlider = document.getElementById("scaleSlider");
  const distortSlider = document.getElementById("distortSlider");
  const invertSlider  = document.getElementById("invertSlider");

  function randomInRange(min, max) {
    return min + Math.random() * (max - min);
  }

  function generateShape() {
    const centerX = 160;
    const centerY = 160;

    const fillValue   = Number(fillSlider.value);    // 0–100
    const bezValue    = Number(bezierSlider.value);  // 0–100
    const scaleValue  = Number(scaleSlider.value);   // 0–100
    const distortValue= Number(distortSlider.value); // 0–100
    const invertValue = Number(invertSlider.value);  // 0–100

    // Hintergrund/Shape invertieren
    if (invertValue > 50) {
      bgRect.setAttribute("fill", "white");
      shapePath.setAttribute("fill", "black");
    } else {
      bgRect.setAttribute("fill", "black");
      shapePath.setAttribute("fill", "white");
    }

    // Anzahl Punkte (leicht variabel)
    const numPoints = 8 + Math.floor(Math.random() * 4); // 8–11

    // Flächenfüllung beeinflusst Basisradius
    const baseRadius   = 40 + (fillValue / 100) * 80;   // ~40–120
    const radiusSpread = 10 + (fillValue / 100) * 40;   // Variabilität

    // Vergrößern-Slider: globale Skalierung
    const scale = 0.6 + (scaleValue / 100) * 0.9;       // 0.6–1.5

    // Verzerren-Slider: Winkel- & Radius-Rauschen
    const angleJitter  = 0.1 + (distortValue / 100) * 0.8; // in Radiant
    const radiusNoise  = 0.3 + (distortValue / 100) * 1.0; // Faktor

    // Bezierkurven-Intensität
    const curveAmount = bezValue / 100; // 0–1

    const points = [];

    // Punkte auf Kreis / verzerrtem Kreis
    for (let i = 0; i < numPoints; i++) {
      const baseAngle = (Math.PI * 2 * i) / numPoints;
      const angle = baseAngle + randomInRange(-angleJitter, angleJitter);

      let radius = baseRadius + randomInRange(-radiusSpread, radiusSpread) * radiusNoise;

      let x = centerX + Math.cos(angle) * radius;
      let y = centerY + Math.sin(angle) * radius;

      // globale Skalierung
      x = centerX + (x - centerX) * scale;
      y = centerY + (y - centerY) * scale;

      points.push({ x, y });
    }

    if (points.length === 0) {
      shapePath.setAttribute("d", "");
      return;
    }

    // Pfad aufbauen: Linien oder Quadratic Beziers
    let d = `M ${points[0].x.toFixed(2)} ${points[0].y.toFixed(2)} `;

    if (curveAmount < 0.05) {
      // fast keine Kurve -> polygonale Form
      for (let i = 1; i < points.length; i++) {
        d += `L ${points[i].x.toFixed(2)} ${points[i].y.toFixed(2)} `;
      }
      d += "Z";
    } else {
      // Quadratische Bezierkurven (Q)
      for (let i = 0; i < points.length; i++) {
        const current = points[i];
        const next = points[(i + 1) % points.length];

        const midX = (current.x + next.x) / 2;
        const midY = (current.y + next.y) / 2;

        // Tangentenvektor
        const vx = next.x - current.x;
        const vy = next.y - current.y;
        const len = Math.hypot(vx, vy) || 1;

        // Normalvektor
        const nx = -vy / len;
        const ny =  vx / len;

        // je nach Kurvenstärke (curveAmount) und Verzerrung verschieben
        const baseOffset = len * 0.4 * curveAmount;
        const jitter = baseOffset * 0.5 * (distortValue / 100);
        const offset = baseOffset + randomInRange(-jitter, jitter);

        // Vorzeichen alternieren für Wellenform
        const dir = (i % 2 === 0) ? 1 : -1;

        const cpX = midX + nx * offset * dir;
        const cpY = midY + ny * offset * dir;

        d += `Q ${cpX.toFixed(2)} ${cpY.toFixed(2)} ${next.x.toFixed(2)} ${next.y.toFixed(2)} `;
      }
      d += "Z";
    }

    shapePath.setAttribute("d", d);
  }

  function clearCanvas() {
    shapePath.setAttribute("d", "");
  }

  function exportSVG() {
    const svg = document.getElementById("shapeCanvas");
    const svgString = new XMLSerializer().serializeToString(svg);
    console.log("SVG-Output:", svgString);
    alert("SVG-String wurde in die Konsole geschrieben.");
  }

  document.getElementById("generateBtn").addEventListener("click", generateShape);
  document.getElementById("clearBtn").addEventListener("click", clearCanvas);
  document.getElementById("exportBtn").addEventListener("click", exportSVG);

  // Slider regen sofort neu
  [fillSlider, bezierSlider, scaleSlider, distortSlider, invertSlider].forEach(el => {
    el.addEventListener("input", generateShape);
  });

  // Startform
  generateShape();
</script>
</body>
</html>
